>> question2
 
e_w3_hat =
 
[                          cos(t3),      -(l0*sin(t3))/(l0^2 + l1^2)^(1/2),       (l1*sin(t3))/(l0^2 + l1^2)^(1/2)]
[ (l0*sin(t3))/(l0^2 + l1^2)^(1/2), (l0^2*(cos(t3) - 1))/(l0^2 + l1^2) + 1,   -(l0*l1*(cos(t3) - 1))/(l0^2 + l1^2)]
[-(l1*sin(t3))/(l0^2 + l1^2)^(1/2),   -(l0*l1*(cos(t3) - 1))/(l0^2 + l1^2), (l1^2*(cos(t3) - 1))/(l0^2 + l1^2) + 1]
 
 
final =
 
[cos(t1)*cos(t3) - (l0*cos(t2)*sin(t1)*sin(t3))/(l0^2 + l1^2)^(1/2) + (l1*sin(t1)*sin(t2)*sin(t3))/(l0^2 + l1^2)^(1/2), (l0*l1*sin(t1)*sin(t2)*(cos(t3) - 1))/(l0^2 + l1^2) - (l0*cos(t1)*sin(t3))/(l0^2 + l1^2)^(1/2) - cos(t2)*sin(t1)*((l0^2*(cos(t3) - 1))/(l0^2 + l1^2) + 1),    (l1*cos(t1)*sin(t3))/(l0^2 + l1^2)^(1/2) - (sin(t1)*sin(t2)*(l0^2 + cos(t3)*l1^2))/(l0^2 + l1^2) + (l0*l1*cos(t2)*sin(t1)*(cos(t3) - 1))/(l0^2 + l1^2), -(l0*cos(t1)*sin(t3)*(l0^2 + l1^2) - l0^2*l2*cos(t2)*sin(t1) + l1*cos(t2)*sin(t1)*(l0^2 + l1^2) + l2*cos(t2)*sin(t1)*(l0^2 + l1^2) + l0*sin(t1)*sin(t2)*(l0^2 + l1^2) + l0^2*l2*cos(t2)*cos(t3)*sin(t1) + l0*l2*cos(t1)*sin(t3)*(l0^2 + l1^2)^(1/2) - l0*cos(t3)*sin(t1)*sin(t2)*(l0^2 + l1^2) + l0*l1*l2*sin(t1)*sin(t2) - l0*l1*l2*cos(t3)*sin(t1)*sin(t2))/(l0^2 + l1^2)]
[cos(t3)*sin(t1) + (l0*cos(t1)*cos(t2)*sin(t3))/(l0^2 + l1^2)^(1/2) - (l1*cos(t1)*sin(t2)*sin(t3))/(l0^2 + l1^2)^(1/2), cos(t1)*cos(t2)*((l0^2*(cos(t3) - 1))/(l0^2 + l1^2) + 1) - (l0*sin(t1)*sin(t3))/(l0^2 + l1^2)^(1/2) - (l0*l1*cos(t1)*sin(t2)*(cos(t3) - 1))/(l0^2 + l1^2), cos(t1)*sin(t2)*((l1^2*(cos(t3) - 1))/(l0^2 + l1^2) + 1) + (l1*sin(t1)*sin(t3))/(l0^2 + l1^2)^(1/2) - (l0*l1*cos(t1)*cos(t2)*(cos(t3) - 1))/(l0^2 + l1^2), -(l0^2*l2*cos(t1)*cos(t2) - l1*cos(t1)*cos(t2)*(l0^2 + l1^2) - l2*cos(t1)*cos(t2)*(l0^2 + l1^2) - l0*cos(t1)*sin(t2)*(l0^2 + l1^2) + l0*sin(t1)*sin(t3)*(l0^2 + l1^2) - l0^2*l2*cos(t1)*cos(t2)*cos(t3) + l0*cos(t1)*cos(t3)*sin(t2)*(l0^2 + l1^2) + l0*l2*sin(t1)*sin(t3)*(l0^2 + l1^2)^(1/2) - l0*l1*l2*cos(t1)*sin(t2) + l0*l1*l2*cos(t1)*cos(t3)*sin(t2))/(l0^2 + l1^2)]
[                                                             -(sin(t3)*(l1*cos(t2) + l0*sin(t2)))/(l0^2 + l1^2)^(1/2),                                                          - sin(t2)*((l0^2*(cos(t3) - 1))/(l0^2 + l1^2) + 1) - (l0*l1*cos(t2)*(cos(t3) - 1))/(l0^2 + l1^2),                                                            cos(t2)*((l1^2*(cos(t3) - 1))/(l0^2 + l1^2) + 1) + (l0*l1*sin(t2)*(cos(t3) - 1))/(l0^2 + l1^2),                                                                                                              l0*(cos(t2)*((l1^2*(cos(t3) - 1))/(l0^2 + l1^2) + 1) + (l0*l1*sin(t2)*(cos(t3) - 1))/(l0^2 + l1^2)) - l0*(cos(t2) - 1) - (l1 + l2)*(sin(t2)*((l0^2*(cos(t3) - 1))/(l0^2 + l1^2) + 1) + (l0*l1*cos(t2)*(cos(t3) - 1))/(l0^2 + l1^2)) - l0*cos(t2)*(cos(t3) - 1)]
[                                                                                                                    0,                                                                                                                                                         0,                                                                                                                                                         0,                                                                                                                                                                                                                                                                                                                                                                           1]
 
 
spatial_jacobian =
 
[0,  l0*sin(t1), -(l0*cos(t1)*(l1*cos(t2) - l1 + l0*sin(t2)))/(l0^2 + l1^2)^(1/2)]
[0, -l0*cos(t1), -(l0*sin(t1)*(l1*cos(t2) - l1 + l0*sin(t2)))/(l0^2 + l1^2)^(1/2)]
[0,           0,                                                                0]
[0,    -cos(t1),         -(sin(t1)*(l1*cos(t2) + l0*sin(t2)))/(l0^2 + l1^2)^(1/2)]
[0,    -sin(t1),          (cos(t1)*(l1*cos(t2) + l0*sin(t2)))/(l0^2 + l1^2)^(1/2)]
[1,           0,                    (l0*cos(t2) - l1*sin(t2))/(l0^2 + l1^2)^(1/2)]
 
 
body_jacobian =
 
[-(l0^2*cos(t2)*(l0^2 + l1^2)^(1/2) - l0^3*cos(t3)^2*sin(t2) + l0^2*l2*cos(t2) + l1^3*cos(t2)*cos(t3) + l0^3*cos(t3)*sin(t2) + l0^2*l1*cos(t2)*cos(t3) + l1^2*l2*cos(t2)*cos(t3) + l0*l1^2*cos(t3)*sin(t2) - l0*l1*sin(t2)*(l0^2 + l1^2)^(1/2) - l0*l1*l2*sin(t2) - l0^2*cos(t2)*cos(t3)^2*(l0^2 + l1^2)^(1/2) - l0*l1^2*cos(t3)^2*sin(t2) + l0*l1*l2*cos(t3)*sin(t2) + l0*l1*cos(t3)^2*sin(t2)*(l0^2 + l1^2)^(1/2))/(l0^2 + l1^2), (l0^2*sin(t3) + l1^2*sin(t3) - (l0^2*sin(2*t3))/2 + l1*l2*sin(t3))/(l0^2 + l1^2)^(1/2), -(l0*(l2 + l1*cos(t3)^2 + (l0^2 + l1^2)^(1/2) - l1*cos(t3) - cos(t3)^2*(l0^2 + l1^2)^(1/2)))/(l0^2 + l1^2)^(1/2)]
[                                                                                                                                                                                                             -(l0*sin(t3)*(l1^2*cos(t2) - l0*sin(t2)*(l0^2 + l1^2)^(1/2) + l0*l1*sin(t2) + l0^2*cos(t2)*cos(t3) - l1*cos(t2)*(l0^2 + l1^2)^(1/2) + l0*cos(t3)*sin(t2)*(l0^2 + l1^2)^(1/2) - l0*l1*cos(t3)*sin(t2)))/(l0^2 + l1^2),                                            -(l0^3*cos(t3)*(cos(t3) - 1))/(l0^2 + l1^2),                          -(l0^2*(2*l1*sin(t3) - l1*sin(2*t3) + sin(2*t3)*(l0^2 + l1^2)^(1/2)))/(2*(l0^2 + l1^2))]
[                                                                                                                         -(sin(t3)*(l0^3*sin(t2) + l1^2*cos(t2)*(l0^2 + l1^2)^(1/2) + l0^2*l1*cos(t2) - l0^2*l1*cos(t2)*cos(t3) + l0*l1^2*cos(t3)*sin(t2) + l1*l2*cos(t2)*(l0^2 + l1^2)^(1/2) + l0*l1*sin(t2)*(l0^2 + l1^2)^(1/2) + l0*l2*sin(t2)*(l0^2 + l1^2)^(1/2) - l0*l1*cos(t3)*sin(t2)*(l0^2 + l1^2)^(1/2)))/(l0^2 + l1^2),      -(cos(t3)*(2*l0^2*l1 + l0^2*l2 + l1^2*l2 + l1^3 - l0^2*l1*cos(t3)))/(l0^2 + l1^2),                          (l0*l1*(2*l1*sin(t3) - l1*sin(2*t3) + sin(2*t3)*(l0^2 + l1^2)^(1/2)))/(2*(l0^2 + l1^2))]
[                                                                                                                                                                                                                                                                                                                                                                         -(sin(t3)*(l1*cos(t2) + l0*sin(t2)))/(l0^2 + l1^2)^(1/2),                                                                               -cos(t3),                                                                                                                0]
[                                                                                                                                                                                                                                                                                                                                 - sin(t2)*((l0^2*(cos(t3) - 1))/(l0^2 + l1^2) + 1) - (l0*l1*cos(t2)*(cos(t3) - 1))/(l0^2 + l1^2),                                                       (l0*sin(t3))/(l0^2 + l1^2)^(1/2),                                                                                           l1/(l0^2 + l1^2)^(1/2)]
[                                                                                                                                                                                                                                                                                                                                   cos(t2)*((l1^2*(cos(t3) - 1))/(l0^2 + l1^2) + 1) + (l0*l1*sin(t2)*(cos(t3) - 1))/(l0^2 + l1^2),                                                      -(l1*sin(t3))/(l0^2 + l1^2)^(1/2),                                                                                           l0/(l0^2 + l1^2)^(1/2)]
 
>> 